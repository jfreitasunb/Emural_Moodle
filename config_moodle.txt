Instalação do MoodleMat:
1) pacotes: apt-get install graphviz aspell php5-pspell php5-curl php5-gd php5-intl php5-mysql php5-xmlrpc php5-ldap

Configurações do MoodleMat:
1) Home -> My profile settings -> Edit profile
a) Email address: moodlemat@mat.unb.br

2) Mudar senha do admin: My profile settings -> Change password

2) Site administration -> Plugins -> Message outputs -> Email 
a) SMTP hosts: mx1.mat.unb.br
b) SMTP username: moodlemat
c) No-reply address: noreply@moodle.mat.unb.br

2) Site administration -> Server -> Support contact
a) Support email: moodlemat@mat.unb.br

3) Permissões de novos Usuários: Site administration -> Users -> Permissions -> Define roles
a) Na linha "Teacher" marcar a coluna "Teacher"

4) Configurações da página inicial e título do Moodle: Site administration -> Front page settings -> Edit settings
a) Full site name: Moodle MAT
b) Short name for site: Moodle
c) Front page items when logged in: Enrolled courses

5) Página de login: Site administration -> Plugins -> Authentication -> Manage authentication
a) Rolar a página até o campo "Instructions" e acrescentar o texto:
"
Caro usuário, se você já é aluno de alguma disciplina do MAT e ainda não efetuou login no MoodleMat, clique aqui(link em vermelho para http://e-mural.mat.unb.br/cadastro.php)!

Nesta página preencha os dados solicitados e informe um endereço de e-mail. Após salvar seu cadastro você receberá uma mensagem de confirmação em seu e-mail."
"

6) Instalação do pt_br:
a) Site administration -> Language -> Language packs: Instalar "Português Brasil"
b) Site administration -> Language -> Language settings: Default language: "Português Brasil"

7) Criação do papel de Monitor: Site administration -> Users -> Permissions -> Define roles
a) Short name: Monitor
b) Custom full name: Estudante(Monitor)
c) Custom description: Perfil para incluir monitores nos curso.
d) Filter -> grade e desabilitar as seguintes opções:
a1) Activity: Assignment
Grade assignment
mod/assign:grade
 Allow
XSS risk			
Review and release grades
mod/assign:managegrades
 Allow
Release grades
mod/assign:releasegrades
 Allow
Review grades
mod/assign:reviewgrades
 Allow
Activity: Assignment (2.2)
Grade assignment
mod/assignment:grade
 Allow
XSS risk			
Activity: LTI
View grades returned by the external tool
mod/lti:grade
 Allow
Privacy risk		
Activity: Quiz
Grade quizzes manually
mod/quiz:grade
 Allow
Spam risk	
Regrade quiz attempts
mod/quiz:regrade
 Allow
Spam risk	
Activity: Workshop
Override calculated grades
mod/workshop:overridegrades


8) Site administration -> Plugins -> Filters -> Manage filters
a) Ativar a opção TeX Notation
b) Ir em Settings e mudar os caminhos:
- LaTeX preamble: \usepackage[utf8]{inputenc}
- Path of latex binary: /usr/bin/latex
- Path of dvips binary: /usr/bin/dvips
- Path of convert binary: /usr/bin/convert
- convert output format: PNG

9) Site administration -> Courses -> Backups -> General backup defaults
a) Desmarcar opção "Include users"


10) Site administration -> Users -> Permissions -> Define roles: Na aba 'Manage roles'
a) Editar o papel de professor e desmarcar 'Manual enrolments -> Unenrol users from the course'
b) Editar o papel de professor e desmarcar 'Unenrol users from the course enrol -> manual:unenrol'

11) Abrir link da senha esquecida em nova janela: Editar arquivo moodle/login/index_form.html e trocar a linha
<div class="forgetpass"><a href="<?php echo $CFG->wwwemural ?>esqueci_senha?moodle"><?php print_string("forgotten") ?></a></div>

Por

<div class="forgetpass"><a target = "_blank" href="<?php echo $CFG->wwwemural ?>esqueci_senha?moodle"><?php print_string("forgotten") ?></a></div>


12) Para permitir a solicitação da criação de novos cursos: Site administration -> Courses -> Course request
a) Marcar a opção 'Enable course requests'
b) Mudar para usuário 'Admin' em 'Course request notification'

13) Para aprovar ou não a criação de um curso: Site administration -> Courses -> Manage courses and categories
a) Clicar no link 'Courses pending approval'

14) Criação de role que permitir criar usuários manualmente: Site administration -> Users -> Permissions -> Define roles:
a0) Role: Co-admin
a) Em 'Manage roles' ir em 'Add a new role'
b) Em 'Use role or archetype' escolher 'Manager'
c) Em 'Context types where this role may be assigned' marcar 'System, User, Category, Course'
d) Em 'Allow role assignments' selecionar Teacher, Estudante(Monitor) e Student
e) Em 'Allow role overrides' selecionar 'Teacher, Estudante(Monitor) e Student'
f) Em 'Allow role switches' selecionar 'Teacher, Estudante(Monitor) e Student'
g) Nas permissões do papel desmarcar tudo com excessão de: View participants, Create users, Configure manual enrol instances, Enrol users, Manage user enrolments, Unenrol users from the course, Manage enrolled users, View hidden courses, View participants.
h) Marcar opções: Update user profiles, Edit user profile
						
15) Criar usuário 'coadmin' com nome "Co-administrador Ajudante".

16) Depois ir em Site administration -> Users -> Permissions -> Assign system roles e colocar na role 'Co-Admin' o usuário 'coadmin'.

17) Configuração abertura de abas do do bloco de navegação de cursos: ir em Home -> Navigation -> Configuration
a) Em 'Generate navigation for the following' escolher 'Categories and courses'

Configurações gerais
1) Criar pasta "anosemestre" no formato "yyyyz", onde Z = 1 ou 2, na pasta "/moodledata"
a) Usar pasta 'moodledata-BASE' para criar as demais.
b) Permissões 777, dono e grupo www-data.

2) Para reativar o tema logue como "admin" e vá em: "Site administration -> Appearance -> Theme selector" e clicar em "Clear theme caches".


3) Para alterar comportamento do 'restore' de cursos:
a) Acessar arquivo 'moodle/backup/util/ui/renderer.php' e mudar as linhas:
$html .= $this->backup_detail_input(get_string('restoretocurrentcourseadding', 'backup'), 'radio', 'target', backup::TARGET_CURRENT_ADDING, array('checked'=>'checked'));
$html .= $this->backup_detail_input(get_string('restoretocurrentcoursedeleting', 'backup'), 'radio', 'target',backup::TARGET_CURRENT_DELETING);

por

$html .= $this->backup_detail_input(get_string('restoretocurrentcourseadding', 'backup'), 'radio', 'target', backup::TARGET_CURRENT_ADDING);
            $html .= $this->backup_detail_input(get_string('restoretocurrentcoursedeleting', 'backup'), 'radio', 'target', backup::TARGET_CURRENT_DELETING, array('checked'=>'checked'));

O efeito da mudança acima é colocar como default o restore deletando o curso atual.


b) Acessar arquivo 'moodle/backup/moodle2/restore_course_task.class.php' e mudar a linha:

$keep_enrols = new restore_course_generic_setting('keep_roles_and_enrolments', base_setting::IS_BOOLEAN, false);

para

$keep_enrols = new restore_course_generic_setting('keep_roles_and_enrolments', base_setting::IS_BOOLEAN, true);

e a linha

$keep_groups = new restore_course_generic_setting('keep_groups_and_groupings', base_setting::IS_BOOLEAN, false);

para

$keep_groups = new restore_course_generic_setting('keep_groups_and_groupings', base_setting::IS_BOOLEAN, true);

O efeito das mudanças acima é manter os usuários e grupos que já tiverem sido criados pelo E-mural.

c) Para ocultar as opções sobreescrever usuários e grupos: abrir arquivo 'moodle/backup/moodle2/restore_course_task.class.php'e acrescentar:

c1) Antes da linha

if ($this->get_target() != backup::TARGET_CURRENT_DELETING and $this->get_target() != backup::TARGET_EXISTING_DELETING) {

O código abaixo:

$keep_enrols->set_visibility(backup_setting::HIDDEN);

c2) Antes da linha

if ($this->get_target() != backup::TARGET_CURRENT_DELETING and $this->get_target() != backup::TARGET_EXISTING_DELETING) {

O código abaixo:

$keep_groups->set_visibility(backup_setting::HIDDEN);

c3) Antes da linha:

if ($this->get_target() == backup::TARGET_NEW_COURSE) {

O código abaixo:

$overwrite->set_visibility(backup_setting::HIDDEN);

4)

Acrescetar no crontab a linha
*/30 * * * * /usr/bin/php  /var/www/moodle/admin/cli/cron.php >/dev/null

para envio de e-mail.